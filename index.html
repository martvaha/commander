<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="stylesheet" href="/src/styles.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Commander - Voice to Text</title>
    <script type="module" src="/src/main.ts" defer></script>
  </head>

  <body>
    <main class="container">
      <div id="ax-banner" style="display:none; background:#fdecea; color:#611a15; border:1px solid #f5c6cb; padding:14px 16px; border-radius:8px; margin: 10px 0;">
        <div style="display:flex; align-items:center; justify-content:space-between; gap:12px; flex-wrap:wrap;">
          <div>
            <strong>Accessibility permission required</strong>
            <div style="font-size:0.95em; color:#7a2c29;">Grant access in System Settings ‚Üí Privacy & Security ‚Üí Accessibility.</div>
          </div>
          <div style="display:flex; gap:8px;">
            <button id="open-ax-settings-btn" style="padding:8px 12px; border:1px solid #b23b3b; background:#b23b3b; color:white; border-radius:6px; cursor:pointer;">Open Settings</button>
            <button id="recheck-ax-btn" style="padding:8px 12px; border:1px solid #b23b3b; background:white; color:#b23b3b; border-radius:6px; cursor:pointer;">Recheck</button>
          </div>
        </div>
      </div>
      <h1>üé§ Commander</h1>
      <p style="font-size: 1.2em">
        Voice-to-text transcription at your fingertips
      </p>

      <div
        style="
          background: #f0f0f0;
          padding: 20px;
          border-radius: 10px;
          margin: 20px 0;
          color: #333;
        "
      >
        <h2>Quick Start</h2>
        <p style="font-size: 1.1em">
          Press your configured shortcut to start recording, press again to stop
          and transcribe.
        </p>
        <p>
          The transcribed text will be automatically copied to your clipboard.
        </p>
      </div>

      <div
        style="
          background: #fff3cd;
          padding: 20px;
          border-radius: 10px;
          margin: 20px 0;
          color: #856404;
        "
      >
        <h3>‚ö†Ô∏è macOS Users</h3>
        <p>
          Commander requires <strong>Accessibility permissions</strong> to
          capture global shortcuts.
        </p>
        <p>
          Go to:
          <strong>System Settings ‚Üí Privacy & Security ‚Üí Accessibility</strong>
        </p>
        <p>Add Commander to the list and enable it.</p>
      </div>

      <div
        style="
          margin: 20px 0;
          padding: 20px;
          background: #f0f0f0;
          border-radius: 10px;
          color: #333;
        "
      >
        <h3>Audio Input Device</h3>
        <p>Select which microphone to use (defaults to system device):</p>
        <select id="audio-device-select" style="padding: 10px; font-size: 1em">
          <option value="">System default</option>
        </select>
        <button id="save-audio-device-btn" style="margin-left: 10px; padding: 10px 20px">
          Save Device
        </button>
        <div id="audio-device-status" style="margin-top: 10px; font-size: 0.9em"></div>
        <div style="margin-top: 16px">
          <div style="display:flex; align-items:center; gap:10px;">
            <div style="min-width:120px;">Live level:</div>
            <div style="flex:1; background:#ddd; height:10px; border-radius:5px; overflow:hidden;">
              <div id="audio-level-bar" style="height:100%; width:0%; background:linear-gradient(90deg, #22E522, #F2B82F, #E52222);"></div>
            </div>
            <div id="audio-level-text" style="min-width:70px; text-align:right; font-family:monospace; font-size:0.9em;">-inf dB</div>
          </div>
        </div>
      </div>

      <div
        style="
          margin: 20px 0;
          padding: 20px;
          background: #f0f0f0;
          border-radius: 10px;
          color: #333;
        "
      >
        <h3>After Transcription</h3>
        <label style="display: flex; align-items: center; gap: 10px">
          <input type="checkbox" id="auto-paste-checkbox" />
          Automatically paste transcribed text
        </label>
        <p style="margin: 8px 0 0; font-size: 0.9em; color: #666">
          If enabled, Commander will press ‚åòV (or Ctrl+V) after copying.
        </p>
        <div style="height: 10px"></div>
        <h3>Recording Mode</h3>
        <label style="display: flex; align-items: center; gap: 10px">
          <input type="checkbox" id="hold-to-record-checkbox" />
          Hold shortcut to record (release to transcribe)
        </label>
        <p style="margin: 8px 0 0; font-size: 0.9em; color: #666">
          When enabled, recording starts on key down and stops on key up. When disabled, press once to start and press again to stop.
        </p>
      </div>

      <div
        style="
          margin: 20px 0;
          padding: 20px;
          background: #f0f0f0;
          border-radius: 10px;
          color: #333;
        "
      >
        <h3>Configure Custom Shortcut</h3>
        <p>Press your desired key combination:</p>
        <input
          id="shortcut-input"
          type="text"
          readonly
          style="
            padding: 10px;
            font-size: 1.1em;
            width: 300px;
            text-align: center;
            border: 2px solid #ccc;
            border-radius: 5px;
            background: white;
            cursor: pointer;
            color: #333;
          "
          placeholder="Click and press keys..."
        />
        <button
          id="save-shortcut-btn"
          style="
            margin-left: 10px;
            padding: 10px 20px;
            background: #4caf50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
          "
          disabled
        >
          Save Shortcut
        </button>
        <div
          id="shortcut-status"
          style="margin-top: 10px; font-size: 0.9em"
        ></div>
      </div>

      <div
        style="
          margin: 20px 0;
          padding: 20px;
          background: #f0f0f0;
          border-radius: 10px;
          color: #333;
        "
      >
        <h3>Default Transcription Language</h3>
        <p>Select the language hint for Whisper (optional):</p>
        <select id="language-select" style="padding: 10px; font-size: 1em">
          <option value="">Auto-detect</option>
          <option value="en">English</option>
          <option value="et">Estonian</option>
          <option value="de">German</option>
          <option value="fr">French</option>
          <option value="es">Spanish</option>
          <option value="it">Italian</option>
          <option value="ru">Russian</option>
          <option value="sv">Swedish</option>
          <option value="fi">Finnish</option>
          <option value="nl">Dutch</option>
          <option value="pt">Portuguese</option>
          <option value="pl">Polish</option>
        </select>
        <button
          id="save-language-btn"
          style="margin-left: 10px; padding: 10px 20px"
        >
          Save Language
        </button>
        <div
          id="language-status"
          style="margin-top: 10px; font-size: 0.9em"
        ></div>
      </div>

      <div
        style="
          margin: 20px 0;
          padding: 20px;
          background: #f0f0f0;
          border-radius: 10px;
          color: #333;
        "
      >
        <h3>Initial Prompt</h3>
        <p>Optional text prepended to the model to guide transcription:</p>
        <textarea
          id="prompt-textarea"
          rows="4"
          style="
            width: 100%;
            padding: 10px;
            font-size: 1em;
            box-sizing: border-box;
            resize: vertical;
          "
          placeholder="E.g. Proper nouns, vocabulary, or context to bias recognition..."
        ></textarea>
        <div style="margin-top: 10px">
          <button id="save-prompt-btn" style="padding: 10px 20px">
            Save Prompt
          </button>
          <span
            id="prompt-status"
            style="margin-left: 10px; font-size: 0.9em"
          ></span>
        </div>
      </div>

      <div
        style="
          margin: 20px 0;
          padding: 20px;
          background: #f0f0f0;
          border-radius: 10px;
          color: #333;
        "
      >
        <h3>Models</h3>
        <div id="models-container"></div>
        <div id="models-status" style="margin-top: 8px; font-size: 0.9em; color: #666"></div>
      </div>

      <div style="margin: 30px 0">
        <button
          id="test-recording-btn"
          style="
            background: #333;
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 8px;
            font-size: 1.1em;
            cursor: pointer;
            transition: all 0.3s ease;
          "
          onmouseover="this.style.opacity='0.9'"
          onmouseout="this.style.opacity='1'"
        >
          üé§ Start Recording
        </button>
        <p style="margin-top: 10px; font-size: 0.9em; color: #a2a2a2">
          Click this button to test recording if the global shortcut isn't
          working
        </p>
      </div>

      <div style="margin-top: 30px">
        <h3>Status</h3>
        <p id="status">Ready</p>
        <div
          id="log"
          style="
            background: #f5f5f5;
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 10px;
            margin-top: 10px;
            max-height: 200px;
            overflow-y: auto;
            font-family: monospace;
            font-size: 0.9em;
            text-align: left;
            color: #333;
          "
        ></div>
      </div>

      <p style="margin-top: 30px; font-size: 0.9em; color: #666">
        Commander runs in the system tray. You can close this window.
      </p>
    </main>
  </body>
</html>
